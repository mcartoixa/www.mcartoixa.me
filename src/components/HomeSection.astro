---
import type { ImageMetadata } from 'astro';
import { getEntry, render } from 'astro:content';
import { Image } from 'astro:assets';
import HomeSectionItem from './HomeSection/HomeSectionItem.astro';

interface Props {
  id: string;
  bgPath: string;
  websites: Array<string>;
}

const { id, bgPath, websites } = Astro.props;
const entry = await getEntry('sections', id);
if (!entry) throw new Error(`Section "${id}" does not exist"`);

const { Content } = await render(entry);

const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/pix/**/*.*');
if (!images[bgPath]) throw new Error(`"${bgPath}" does not exist"`);
---

<section id={id} class="relative overflow-hidden px-4 py-20">
  <Image
    src={images[bgPath]()}
    alt={id}
    class="absolute top-0 left-0 -z-1 h-full w-full object-cover object-center brightness-50"
  />
  <div class="flex flex-row">
    {
      websites?.map(website => (
        <div class="m-4 min-w-80 text-center" class:list={[{'w-1/2': websites.length === 2, 'w-1/3': websites.length >= 3}]}>
          <HomeSectionItem website={website} />
        </div>
      ))
    }
  </div>
  <div class="content m-8 font-light text-white">
    <Content />
  </div>
</section>
